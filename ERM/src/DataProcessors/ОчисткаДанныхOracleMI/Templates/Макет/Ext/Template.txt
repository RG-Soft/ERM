USE ERM;

DECLARE @MySource binary(16);
SET @MySource = (SELECT EN._IDRRef FROM _#ИмяТаблицыПеречисления# AS EN WHERE EN._EnumOrder = #НомерЭлементаПеречисления#);

-- unbilled AR
-- движения
PRINT N'Начало удаления движений UnbilledAR '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
DELETE
FROM dbo._#ИмяТаблицы_UnbilledAR_Движения#
WHERE _#ИмяПоля_UnbilledAR#RRef = @MySource;


-- unbilled AR
-- итоги
DELETE
FROM dbo._#ИмяТаблицы_UnbilledAR_Итоги#
WHERE _#ИмяПоля_UnbilledAR#Ref = @MySource;
PRINT N'Движения UnbilledAR удалены '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 

PRINT N'Начало удаления движений billedAR '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
-- billed AR
-- движения
DELETE
FROM dbo._#ИмяТаблицы_billedAR_Движения#
WHERE _#ИмяПоля_billedAR#Ref = @MySource;

-- billed AR
-- итоги
DELETE
FROM dbo._#ИмяТаблицы_billedAR_Итоги#
WHERE _#ИмяПоля_billedAR#Ref = @MySource;
PRINT N'Движения billedAR удалены '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 

PRINT N'Начало удаления движений UnallocatedCash '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
-- UnallocatedCash
-- движения
DELETE
FROM dbo._#ИмяТаблицы_UnallocatedCash_Движения#
WHERE _#ИмяПоля_UnallocatedCash#Ref = @MySource;

-- UnallocatedCash
-- итоги
DELETE
FROM dbo._#ИмяТаблицы_UnallocatedCash_Итоги#
WHERE _#ИмяПоля_UnallocatedCash#Ref = @MySource;
PRINT N'Движения UnallocatedCash удалены '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 

PRINT N'Начало удаления движений ManualTransactions '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
-- ManualTransactions
-- движения
DELETE
FROM dbo._#ИмяТаблицы_ManualTransactions_Движения#
WHERE _#ИмяПоля_ManualTransactions#Ref = @MySource;

-- ManualTransactions
-- итоги
DELETE
FROM dbo._#ИмяТаблицы_ManualTransactions_Итоги#
WHERE _#ИмяПоля_ManualTransactions#Ref = @MySource;
PRINT N'Движения ManualTransactions удалены '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 

PRINT N'Начало удаления движений UnallocatedMemo '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
-- UnallocatedMemo
-- движения
DELETE
FROM dbo._#ИмяТаблицы_UnallocatedMemo_Движения#
WHERE _#ИмяПоля_UnallocatedMemo#Ref = @MySource;

-- UnallocatedMemo
-- итоги
DELETE
FROM dbo._#ИмяТаблицы_UnallocatedMemo_Итоги#
WHERE _#ИмяПоля_UnallocatedMemo#Ref = @MySource;
PRINT N'Движения UnallocatedMemo удалены '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 

-- Документы транзакции
PRINT N'Начало удаления транзакций '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
DELETE
FROM dbo._#ИмяТаблицыТранзакций#
WHERE _#ИмяПоляТранзакций#Ref = @MySource;
PRINT N'Транзакции удалены '+ RTRIM(CAST(GETDATE() AS nvarchar(30))) + N'.'; 
